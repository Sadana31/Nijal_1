<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IRM Details</title>

  <link href="../styles/ms.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
</head>
<body>

  <div id="sidebar-placeholder"></div>

  <div class="main-content" id="main-content">
    <h2>IRM Management</h2>

    <div class="search-container">
      <label for="irm-search-field">Search by:</label>
      <select id="irm-search-field">
        <option value="refNumber">Remittance Reference Number</option>
        <option value="irmDate">IRM Date</option>
        <option value="bankName">Bank Name</option>
        <option value="remitterBank">Remitter Bank</option>
        <option value="remitterName">Remitter Name</option>
        <option value="remitterCountryCode">Remitter Country Code</option>
        <option value="status">Status</option>
        <option value="remittanceAmount">Remittance Amount</option>
      </select>

      <input type="text" id="irm-search-value" placeholder="Enter search value" />
      <button class="btn" id="search-btn">Search</button>
    </div>


    <div style="text-align: right; margin-bottom: 20px;">
      <label for="entriesSelect">Show 
        <select id="entriesSelect" onchange="changeEntries()">
          <option value="10">5</option>
          <option value="20" selected>10</option>
          <option value="50">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select> entries
      </label>
    </div>


    <table border="1" style="width: 100%; border-collapse: collapse;" id="mainTable">
      <thead>
        <tr>
          <th></th>
          <th>Sr. No.</th>
          <th>Bank Name</th>
          <th>Remittance Reference Number</th>
          <th>Remittance Date</th>
          <th>Purpose Code</th>
          <th>Remittance Currency</th>
          <th>Remittance Amount</th>
          <th>Outstanding amount</th>
          <th>Remitter Name</th>
        </tr>
      </thead>
      <tbody>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>1</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>$40,000.00</td>
          <td>$40,000.00</td>
          <td>ABC Limited</td>
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>2</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>$40,000.00</td>
          <td>$40,000.00</td>
          <td>ABC Limited</td>
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>3</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>$40,000.00</td>
          <td>$40,000.00</td>
          <td>ABC Limited</td>
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>4</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>$40,000.00</td>
          <td>$40,000.00</td>
          <td>ABC Limited</td>
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>5</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>$40,000.00</td>
          <td>$40,000.00</td>
          <td>ABC Limited</td>
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>6</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>$40,000.00</td>
          <td>$40,000.00</td>
          <td>ABC Limited</td>
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
       </tbody>
    </table>

    <br />

    <div class="button-group">
      <button onclick="window.location.href='add_irm.html'" class="btn">Add IRM</button>
      <button onclick="window.location.href='upload_irm.html'" class="btn">Bulk IRM Upload</button>
      <button class="btn" onclick="downloadSample()">Export File</button>
    </div>

  </div>

  <!-- Toggle expander JS -->
  <script>
    function toggleExpander(el) {
      const row = el.parentElement;
      const nextRow = row.nextElementSibling;
      const expanded = nextRow.style.display === 'table-row';
      nextRow.style.display = expanded ? 'none' : 'table-row';
      el.textContent = expanded ? '▸' : '▾';
    }
  </script>

  <!-- Sidebar loader -->
  <script src="../sidebar/sidebar_loader.js" defer></script>

  <!-- Search field dynamic placeholder -->
  <script>
    function downloadSample() {
      window.location.href = "../files/sample_irm.csv";
    }

    const irmSearchField = document.getElementById('irm-search-field');
    const irmSearchValue = document.getElementById('irm-search-value');

    irmSearchField.addEventListener('change', () => {
      const field = irmSearchField.value;
      let placeholder = 'Enter search value';
      switch (field) {
        case 'refNumber': placeholder = 'Enter Remittance Reference Number'; break;
        case 'irmDate': placeholder = 'Enter IRM Date'; break;
        case 'bankName': placeholder = 'Enter Bank Name'; break;
        case 'remitterBank': placeholder = 'Enter Remitter Bank'; break;
        case 'remitterName': placeholder = 'Enter Remitter Name'; break;
        case 'remitterCountryCode': placeholder = 'Enter Remitter Country Code'; break;
        case 'status': placeholder = 'Enter Status'; break;
        case 'remittanceAmount': placeholder = 'Enter Remittance Amount'; break;
      }
      irmSearchValue.placeholder = placeholder;
    });
  </script>

  <script>
    function toggleExpander(el) {
        const mainRow = el.parentElement;
        const expanderRow = mainRow.nextElementSibling;

        if (!expanderRow || !expanderRow.classList.contains('expander')) return;

        if (expanderRow.style.display === 'table-row') {
          expanderRow.style.display = 'none';
          el.textContent = '▸';
        } else {
          expanderRow.style.display = 'table-row';
          el.textContent = '▾';
        }
      }

      function changeEntries() {
        const table = document.getElementById('mainTable');
        const rows = Array.from(table.querySelectorAll('tbody > tr'));

        // Filter main rows (ignore expanders)
        const mainRows = rows.filter(row => !row.classList.contains('expander'));
        const selected = parseInt(document.getElementById('entriesSelect').value);

        let shownCount = 0;
        for (let i = 0; i < mainRows.length; i++) {
          const mainRow = mainRows[i];
          const expanderRow = mainRow.nextElementSibling && mainRow.nextElementSibling.classList.contains('expander')
            ? mainRow.nextElementSibling
            : null;

          if (shownCount < selected) {
            mainRow.style.display = '';
            if (expanderRow) {
              const toggleCell = mainRow.querySelector('.expand-toggle');
              expanderRow.style.display = (toggleCell && toggleCell.textContent === '▾') ? 'table-row' : 'none';
            }
            shownCount++;
          } else {
            mainRow.style.display = 'none';
            if (expanderRow) expanderRow.style.display = 'none';

            // Reset toggle arrow
            const toggleCell = mainRow.querySelector('.expand-toggle');
            if (toggleCell) toggleCell.textContent = '▸';
          }
        }
      }

      window.onload = () => {
        changeEntries();
      };
    </script>

</body>
</html>
