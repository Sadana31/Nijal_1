<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SB to IRM Mapping</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous" />
  <link rel="stylesheet" href="../styles/mapping.css"/>
</head>
<body>

  <div id="sidebar-placeholder"></div>


  <div class="main-content" id="sb-section">
    <div class="table-container">
    <div class="section-title">Selected Shipping Bill</div>

    <table border="1" id="mainTable" style="width: 100%;">
      <thead>
        <tr>
          <th></th>
          <th>Shipping Bill</th>
          <th>Form No</th>
          <th>Shipping Bill Date</th>
          <th>Port Code</th>
          <th>Bank Name</th>
          <th>Invoice Count</th>
          <th>FOB Currency</th>
          <th>Export Bill Value</th>
          <th>Bill Outstanding Value</th>
          <th>Buyer Name</th>
          <th>Buyer Country Code</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none; text-align:center; font-weight:bold;">
            ▸
          </td>
          <td>1234567</td>
          <td>NA</td>
          <td>10-05-2024</td>
          <td>INBOM4</td>
          <td>ICICI Bank</td>
          <td>1</td>
          <td>USD</td>
          <td>10,000.00</td>
          <td>6,000.00</td>
<td>ABC Limited</td>
    <td>US</td>
        </tr>

        <tr class="expander" style="display: none;">
          <td colspan="13" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>IE Code</th>
                  <th>Invoice Date</th>
                  <th>Realized Value</th>
                  <th>Buyer Address</th>
                  <th>Consignee Country Code</th>
                  <th>Port of Destination</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>123456789</td>
                  <td>05-05-2024</td>
                  <td>$4,000.00</td>
                  <td>Test Address</td>
                  <td>IN</td>
                  <td>US</td>
                </tr>
              </tbody>

              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>Shipping Company</th>
                  <th>Vessel Name</th>
                  <th>BL Date</th>
                  <th>Commercial Invoice</th>
                  <th>Trade Terms</th>
                  <th>Commodity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Maersk</td>
                  <td>Vessel 55555</td>
                  <td>06-05-2024</td>
                  <td>21127240024</td>
                  <td>-</td>
                  <td>Heavy metal goods</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
        </tbody>
      </table>
  </div>


  <div id="table-container">
  <div class="section-title" style="margin-top: 40px;">Select IRMs to Map</div>

    <table border="1" style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th>Bank Name</th>
          <th>Remittance Reference Number</th>
          <th>Remittance Date</th>
          <th>Purpose Code</th>
          <th>Remittance Currency</th>
          <th>Remittance Amount</th>
          <th>Outstanding amount</th>
          <th>Remitter Name</th>
          <th>Utilization Amount </th>
        </tr>
      </thead>
      <tbody>

        <tr>
          <td><input type="checkbox" name="irmSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>40,000.00</td>
          <td>40,000.00</td>
<td>ABC Limited</td>
          <td>
            <input type="number" class="util-input" step="0.01" min="0" />
          </td>      
        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="irmSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>40,000.00</td>
          <td>40,000.00</td>
<td>ABC Limited</td>
          <td>
            <input type="number" class="util-input" step="0.01" min="0" />
          </td>        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="irmSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>40,000.00</td>
          <td>40,000.00</td>
<td>ABC Limited</td>
          <td>
            <input type="number" class="util-input" step="0.01" min="0" />
          </td>        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="irmSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>40,000.00</td>
          <td>40,000.00</td>
<td>ABC Limited</td>
          <td>
            <input type="number" class="util-input" step="0.01" min="0" />
          </td>        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="irmSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>40,000.00</td>
          <td>40,000.00</td>
<td>ABC Limited</td>
          <td>
            <input type="number" class="util-input" step="0.01" min="0" />
          </td>        </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

    <div class="map-button" id="sb">
      <button class="btn-map" >Map Selected IRMs</button>
    </div>
  </div>

  </div>

  <div class="main-content" id="irm-section">

    <div class="table-container">
          <div class="section-title">Selected IRM </div>

      <table border="1" style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th></th>
          <th>Bank Name</th>
          <th>Remittance Reference Number</th>
          <th>Remittance Date</th>
          <th>Purpose Code</th>
          <th>Remittance Currency</th>
          <th>Remittance Amount</th>
          <th>Outstanding amount</th>
          <th>Remitter Name</th>
        </tr>
      </thead>
      <tbody>

        <tr>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none;">▸</td>
          <td>ICICI Bank</td>
          <td>0002GRS12345678</td>
          <td>05-05-2024</td>
          <td>P0102</td>
          <td>USD</td>
          <td>40,000.00</td>
          <td>40,000.00</td>
<td>ABC Limited</td>
     </tr>
        <tr class="expander" style="display: none;">
          <td colspan="10" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>AD Code</th>
                  <th>IE Code</th>
                  <th>Remitter Country Code</th>
                  <th>Remitter Bank</th>
                  <th>Other Bank Reference Number</th>
                  <th>Status</th>
                  <th>Remittance Type</th>
                  <th>Utilized Amount</th>
                  <th>Remitter Address</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>6390000</td>
                  <td>123456789</td>
                  <td>US</td>
                  <td>CITI Bank</td>
                  <td>Test123456</td>
                  <td>Unutilized</td>
                  <td>IRM</td>
                  <td>$0.00</td>
                  <td>Test Address</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
        </tbody>
        </table>
    </div>

    <div class="section-title" style="margin-top: 40px;">Select Shipping Bills</div>
     <table border="1" id="mainTable" style="width: 100%;">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th>Shipping Bill</th>
          <th>Form No</th>
          <th>Shipping Bill Date</th>
          <th>Port Code</th>
          <th>Bank Name</th>
          <th>Invoice Count</th>
          <th>FOB Currency</th>
          <th>Export Bill Value</th>
          <th>Bill Outstanding Value</th>
          <th>Buyer Name</th>
          <th>Buyer Country Code</th>
          <th>Utilization Amount</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="checkbox" name="sbSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none; text-align:center; font-weight:bold;">
            ▸
          </td>
          <td>1234567</td>
          <td>NA</td>
          <td>10-05-2024</td>
          <td>INBOM4</td>
          <td>ICICI Bank</td>
          <td>1</td>
          <td>USD</td>
          <td>10,000.00</td>
          <td>6,000.00</td>
<td>ABC Limited</td>       <td>US</td>
<td><input type="number" class="util-input" step="0.01" min="0" /></td> 
        </tr>

        <tr class="expander" style="display: none;">
          <td colspan="13" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>IE Code</th>
                  <th>Invoice Date</th>
                  <th>Realized Value</th>
                  <th>Buyer Address</th>
                  <th>Consignee Country Code</th>
                  <th>Port of Destination</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>123456789</td>
                  <td>05-05-2024</td>
                  <td>$4,000.00</td>
                  <td>Test Address</td>
                  <td>IN</td>
                  <td>US</td>
                </tr>
              </tbody>

              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>Shipping Company</th>
                  <th>Vessel Name</th>
                  <th>BL Date</th>
                  <th>Commercial Invoice</th>
                  <th>Trade Terms</th>
                  <th>Commodity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Maersk</td>
                  <td>Vessel 55555</td>
                  <td>06-05-2024</td>
                  <td>21127240024</td>
                  <td>-</td>
                  <td>Heavy metal goods</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="sbSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none; text-align:center; font-weight:bold;">
            ▸
          </td>
          <td>1234567</td>
          <td>NA</td>
          <td>10-05-2024</td>
          <td>INBOM4</td>
          <td>ICICI Bank</td>
          <td>1</td>
          <td>USD</td>
          <td>10,000.00</td>
          <td>6,000.00</td>
<td>ABC Limited</td>      <td>US</td>
<td><input type="number" class="util-input" step="0.01" min="0" /></td> 
        </tr>

        <tr class="expander" style="display: none;">
          <td colspan="13" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>IE Code</th>
                  <th>Invoice Date</th>
                  <th>Realized Value</th>
                  <th>Buyer Address</th>
                  <th>Consignee Country Code</th>
                  <th>Port of Destination</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>123456789</td>
                  <td>05-05-2024</td>
                  <td>$4,000.00</td>
                  <td>Test Address</td>
                  <td>IN</td>
                  <td>US</td>
                </tr>
              </tbody>

              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>Shipping Company</th>
                  <th>Vessel Name</th>
                  <th>BL Date</th>
                  <th>Commercial Invoice</th>
                  <th>Trade Terms</th>
                  <th>Commodity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Maersk</td>
                  <td>Vessel 55555</td>
                  <td>06-05-2024</td>
                  <td>21127240024</td>
                  <td>-</td>
                  <td>Heavy metal goods</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="sbSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none; text-align:center; font-weight:bold;">
            ▸
          </td>
          <td>1234567</td>
          <td>NA</td>
          <td>10-05-2024</td>
          <td>INBOM4</td>
          <td>ICICI Bank</td>
          <td>1</td>
          <td>USD</td>
          <td>10,000.00</td>
          <td>6,000.00</td>
<td>ABC Limited</td>
         <td>US</td>
<td><input type="number" class="util-input" step="0.01" min="0" /></td> 
        </tr>

        <tr class="expander" style="display: none;">
          <td colspan="13" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>IE Code</th>
                  <th>Invoice Date</th>
                  <th>Realized Value</th>
                  <th>Buyer Address</th>
                  <th>Consignee Country Code</th>
                  <th>Port of Destination</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>123456789</td>
                  <td>05-05-2024</td>
                  <td>$4,000.00</td>
                  <td>Test Address</td>
                  <td>IN</td>
                  <td>US</td>
                </tr>
              </tbody>

              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>Shipping Company</th>
                  <th>Vessel Name</th>
                  <th>BL Date</th>
                  <th>Commercial Invoice</th>
                  <th>Trade Terms</th>
                  <th>Commodity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Maersk</td>
                  <td>Vessel 55555</td>
                  <td>06-05-2024</td>
                  <td>21127240024</td>
                  <td>-</td>
                  <td>Heavy metal goods</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>

        <tr>
          <td><input type="checkbox" name="sbSelect" value="0002GRS12345678"></td>
          <td class="expand-toggle" onclick="toggleExpander(this)" style="cursor: pointer; user-select:none; text-align:center; font-weight:bold;">
            ▸
          </td>
          <td>1234567</td>
          <td>NA</td>
          <td>10-05-2024</td>
          <td>INBOM4</td>
          <td>ICICI Bank</td>
          <td>1</td>
          <td>USD</td>
          <td>10,000.00</td>
          <td>6,000.00</td>
<td>ABC Limited</td>
      <td>US</td>
<td><input type="number" class="util-input" step="0.01" min="0" /></td> 
        </tr>

        <tr class="expander" style="display: none;">
          <td colspan="13" style="padding: 0;">
            <table border="1" style="width: 100%; border-collapse: collapse; margin: 0;">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>IE Code</th>
                  <th>Invoice Date</th>
                  <th>Realized Value</th>
                  <th>Buyer Address</th>
                  <th>Consignee Country Code</th>
                  <th>Port of Destination</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>123456789</td>
                  <td>05-05-2024</td>
                  <td>$4,000.00</td>
                  <td>Test Address</td>
                  <td>IN</td>
                  <td>US</td>
                </tr>
              </tbody>

              <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th>Shipping Company</th>
                  <th>Vessel Name</th>
                  <th>BL Date</th>
                  <th>Commercial Invoice</th>
                  <th>Trade Terms</th>
                  <th>Commodity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Maersk</td>
                  <td>Vessel 55555</td>
                  <td>06-05-2024</td>
                  <td>21127240024</td>
                  <td>-</td>
                  <td>Heavy metal goods</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr> 
        </tbody>
      </table>

      <div class="map-button" id="irm">
      <button class="btn-map" >Map Selected SBs</button>
    </div>
  </div>

  <!-- Toast Container -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 9999">
  <div id="mappingToast" class="toast align-items-center text-white border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div id="toastMsg" class="toast-body"></div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>

<div id="outstanding" data-value="6000"></div>

  </div>

  <script>
    function toggleExpander(el) {
    const row = el.parentElement;
    const nextRow = row.nextElementSibling;
    if (!nextRow || !nextRow.classList.contains('expander')) return;
    const expanded = nextRow.style.display === 'table-row';
    nextRow.style.display = expanded ? 'none' : 'table-row';
    el.textContent = expanded ? '▸' : '▾';
  }
  </script>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    const params = new URLSearchParams(window.location.search);
    const focus = params.get('focus');

    const sbSection = document.getElementById('sb-section');
    const irmSection = document.getElementById('irm-section');

    if (focus === 'irm') {
      sbSection.classList.add('hidden');
      irmSection.classList.remove('hidden');
    } else {
      sbSection.classList.remove('hidden');
      irmSection.classList.add('hidden');
    }
  });
</script>

<script>
  function isAnyCheckboxChecked(name) {
    return document.querySelectorAll(`input[name="${name}"]:checked`).length > 0;
  }

  function showToast(message, type = "success") {
    const toastEl = document.getElementById("mappingToast");
    const toastMsg = document.getElementById("toastMsg");
    toastMsg.textContent = message;

    toastEl.classList.remove("text-bg-success", "text-bg-danger");
    toastEl.classList.add(type === "success" ? "text-bg-success" : "text-bg-danger");

    const toast = new bootstrap.Toast(toastEl);
    toast.show();
  }

  document.getElementById("sb")?.addEventListener("click", function () {
    if (!isAnyCheckboxChecked("irmSelect")) {
      showToast("❌ Please select at least one IRM to map.", "danger");
      return;
    }
    if(validateUtilizationMatchSB()){
      showToast("✅ Shipping Bill Mapped to the selected IRMs!", "success");
      setTimeout(() => window.location.href = "sb.html", 1000);
    }
  });

  document.getElementById("irm")?.addEventListener("click", function () {
    if (!isAnyCheckboxChecked("sbSelect")) {
      showToast("❌ Please select at least one Shipping Bill to map.", "danger");
      return;
    }
    
    if(validateUtilizationMatchIRM()){
      showToast("✅ IRM mapped to the selected Shipping Bills!", "success");
      setTimeout(() => window.location.href = "irm.html", 1000);
    }
    
  });
</script>

<script>
function validateUtilizationMatchSB() {
  const sbOutstandingStr = document.querySelector("#mainTable tbody tr td:nth-child(10)").innerText;
  const sbOutstanding = parseFloat(sbOutstandingStr.replace(/,/g, ''));

  let totalUtil = 0;

  const irmRows = document.querySelectorAll("#table-container tbody tr");
  for (let i = 0; i < irmRows.length; i += 2) {
    const mainRow = irmRows[i];

    const checkbox = mainRow.querySelector('input[type="checkbox"]');
    if (checkbox && checkbox.checked) {
      const input = mainRow.querySelector('input.util-input');
      if (input && input.value) {
        totalUtil += parseFloat(input.value);
      }
    }
  }

  if (totalUtil !== sbOutstanding) {
    showToast(`Utilization total (${totalUtil.toFixed(2)}) does not match SB outstanding (${sbOutstanding.toFixed(2)}).`,"danger");
    return false;
  }

  showToast("Utilization matches outstanding amount.","success");
  return true;
}

function validateUtilizationMatchIRM() {
  const irmRows = document.querySelectorAll("#table-container tbody tr");
  let irmOutstanding = 40000;
  
  // Find selected IRM and get its outstanding value
  for (let i = 0; i < irmRows.length; i += 2) {
    const row = irmRows[i];
    const checkbox = row.querySelector('input[type="checkbox"]');
    if (checkbox && checkbox.checked) {
      const outValStr = row.querySelector("td:nth-child(10)")?.innerText || "0";
      irmOutstanding = parseFloat(outValStr.replace(/,/g, ""));
      break; // Assume only one IRM is selected
    }
  }

  let totalUtil = 0;
  const sbRows = document.querySelectorAll("#mainTable tbody tr");

  for (let row of sbRows) {
    const checkbox = row.querySelector('input[type="checkbox"]');
    if (checkbox && checkbox.checked) {
      const input = row.querySelector('input.util-input');
      if (input && input.value) {
        totalUtil += parseFloat(input.value);
      }
    }
  }

  if (totalUtil !== irmOutstanding) {
    showToast(`Utilization total (${totalUtil.toFixed(2)}) does not match IRM outstanding (${irmOutstanding.toFixed(2)}).`,"danger");
    return false;
  }

  showToast("Utilization matches outstanding amount.","success");
  return true;
}
</script>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>



  <script src="../sidebar/sidebar_loader.js"></script>
</body>
</html>
